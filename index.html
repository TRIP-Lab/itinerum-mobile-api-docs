
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>Itinerum API Reference</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .cd {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .nl {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <link href="stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" media="print" />
      <script src="javascripts/all.js"></script>
  </head>

  <body class="index" data-languages="[&quot;python&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" alt="Navbar" />
      </span>
    </a>
    <div class="toc-wrapper">
      <img src="images/logo.png" class="logo" alt="Logo" />
        <div class="lang-selector">
              <a href="#" data-language-name="python">python</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc" class="toc-list-h1">
          <li>
            <a href="#introduction" class="toc-h1 toc-link" data-title="introduction">Introduction</a>
          </li>
          <li>
            <a href="#create-a-new-user" class="toc-h1 toc-link" data-title="create-a-new-user">Create a New User</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#http-request" class="toc-h2 toc-link" data-title="http-request">HTTP Request</a>
                  </li>
                  <li>
                    <a href="#query-parameters" class="toc-h2 toc-link" data-title="query-parameters">Query Parameters</a>
                  </li>
                  <li>
                    <a href="#parsing-the-survey" class="toc-h2 toc-link" data-title="parsing-the-survey">Parsing the Survey</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#updating-the-database" class="toc-h1 toc-link" data-title="updating-the-database">Updating the Database</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#answering-the-survey" class="toc-h2 toc-link" data-title="answering-the-survey">Answering the Survey</a>
                  </li>
                  <li>
                    <a href="#adding-coordinates" class="toc-h2 toc-link" data-title="adding-coordinates">Adding Coordinates</a>
                  </li>
                  <li>
                    <a href="#upserting-prompts" class="toc-h2 toc-link" data-title="upserting-prompts">Upserting Prompts</a>
                  </li>
                  <li>
                    <a href="#adding-cancelled-prompts" class="toc-h2 toc-link" data-title="adding-cancelled-prompts">Adding Cancelled Prompts</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#errors" class="toc-h1 toc-link" data-title="errors">Errors</a>
          </li>
      </div>
        <ul class="toc-footer">
            <li><a href='http://itinerum.ca/'>Itinerum Project</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id='introduction'>Introduction</h1>
<p><strong>Welcome to the Itinerum API!</strong> This documentation describes getting started with the mobile API endpoints for authentication, retrieving survey questions, mode prompts, and uploading user data.</p>

<p>There are 3 types of requests an application will make:</p>

<ol>
<li>Initial request where user account is created and survey schema is sent to device</li>
<li>Second POST to server where demographic survey responses are submitted</li>
<li>All subsequent server calls to add new GPS points, prompt responses and cancelled prompts</li>
</ol>
<h1 id='create-a-new-user'>Create a New User</h1><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">requests</span>

<span class="n">url</span> <span class="o">=</span> <span class="n">API_URL</span> <span class="o">+</span> <span class="s">'/create'</span>

<span class="n">test_data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">"lang"</span><span class="p">:</span> <span class="s">"en"</span><span class="p">,</span>
    <span class="s">"surveyName"</span><span class="p">:</span> <span class="s">"test"</span><span class="p">,</span>
    <span class="s">"user"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">"itinerumVersion"</span><span class="p">:</span> <span class="s">"12c"</span><span class="p">,</span>
        <span class="s">"uuid"</span><span class="p">:</span> <span class="s">"7077a34e-afe5-4c22-bd96-119256b7dc51"</span><span class="p">,</span>
        <span class="s">"osVersion"</span><span class="p">:</span> <span class="s">"80.23"</span><span class="p">,</span>
        <span class="s">"model"</span><span class="p">:</span> <span class="s">"iPhone 4s"</span><span class="p">,</span>
        <span class="s">"os"</span><span class="p">:</span> <span class="s">"ios"</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="n">parameters</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">parameters</span><span class="p">)</span>
</code></pre>
<p>A new user is created within a survey by supplying a generated UUID to identify the user within the database. This needs to be cached within the app as it is required for subsequent requests to the API. <em>Relying on the mobile application to generate the UUID is a carry-over from a legacy version of the platform, but retained for backwards compatibility. The possibility of UUID collision is exceedingly remote and was not deemed sufficient to change to a server-side implementation.</em></p>

<p>The <code>avatar</code> path provides the relative URI of the survey&#39;s branding avatar. If no avatar is set, a <code>null</code> value will be returned and <code>defaultAvatar</code> should be referenced for the default Itinerum badge. In the example above, the full path would then be: <code>https://&lt;dashboard.url&gt;/assets/static/avatars/93jf3.jpg</code>.</p>

<aside class="notice">
The original implementation of the API implemented and documented key names inconsistently between camelCase and underscored key names. All network API calls should exclusively use camelCase naming and will be mandatory in future versions of the API. The <code>/mobile/v1</code> version is backwards compatible with both versions, but is deprecated will be disabled once it has been determined all active mobile apps are responding to the upcoming <code>/mobile/v2</code> API.</aside>
<h3 id='http-request'>HTTP Request</h3>
<p><code>POST http://&lt;api.root.url&gt;/mobile/v1/create</code></p>
<h3 id='query-parameters'>Query Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>user</td>
<td>Dictionary containing <code>uuid</code>, <code>model</code>, <code>itinerumVersion</code>, <code>os</code>, <code>osVersion</code></td>
</tr>
<tr>
<td>surveyName</td>
<td>Name of survey to associate the user</td>
</tr>
</tbody></table>
<h2 id='parsing-the-survey'>Parsing the Survey</h2>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"uuid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"43f8cdaf-3e43-429d-beb2-94e8220a8a06"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"lang"</span><span class="p">:</span><span class="w"> </span><span class="s2">"en"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"termsOfService"</span><span class="p">:</span><span class="w"> </span><span class="s2">"terms of service text"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"aboutText"</span><span class="p">:</span><span class="w"> </span><span class="s2">"information about survey instance text"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"contactEmail"</span><span class="p">:</span><span class="w"> </span><span class="s2">"contact@email.com"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"avatar"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"defaultAvatar"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/assets/static/defaultAvatar.png"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"surveyName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"tester"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"surveyId"</span><span class="p">:</span><span class="w"> </span><span class="mi">22</span><span class="p">,</span><span class="w">
    </span><span class="s2">"survey"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"colName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"member_type"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"prompt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"What is your primary occupation?"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">104</span><span class="p">,</span><span class="w">
            </span><span class="s2">"fields"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="s2">"choices"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"0"</span><span class="p">,</span><span class="w"> </span><span class="s2">"1"</span><span class="p">,</span><span class="w"> </span><span class="s2">"2"</span><span class="p">,</span><span class="w"> </span><span class="s2">"3"</span><span class="p">,</span><span class="w"> </span><span class="s2">"4"</span><span class="p">,</span><span class="w"> </span><span class="s2">"5"</span><span class="p">]</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"colName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"travel_mode_work"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"prompt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"How do you typically commute to your work location?"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">110</span><span class="p">,</span><span class="w">
            </span><span class="s2">"fields"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="s2">"choices"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"0"</span><span class="p">,</span><span class="w"> </span><span class="s2">"1"</span><span class="p">,</span><span class="w"> </span><span class="s2">"2"</span><span class="p">,</span><span class="w"> </span><span class="s2">"3"</span><span class="p">,</span><span class="w"> </span><span class="s2">"4"</span><span class="p">,</span><span class="w"> </span><span class="s2">"5"</span><span class="p">,</span><span class="w"> </span><span class="s2">"6"</span><span class="p">]</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"colName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"travel_mode_alt_work"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"prompt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Do you use any alternative mode of travel to work?"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">111</span><span class="p">,</span><span class="w">
            </span><span class="s2">"fields"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="s2">"choices"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"0"</span><span class="p">,</span><span class="w"> </span><span class="s2">"1"</span><span class="p">,</span><span class="w"> </span><span class="s2">"2"</span><span class="p">,</span><span class="w"> </span><span class="s2">"3"</span><span class="p">,</span><span class="w"> </span><span class="s2">"4"</span><span class="p">,</span><span class="w"> </span><span class="s2">"5"</span><span class="p">,</span><span class="w"> </span><span class="s2">"6"</span><span class="p">,</span><span class="w"> </span><span class="s2">"7"</span><span class="p">]</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"colName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"travel_mode_study"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"prompt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"How do you typically commute to your studies?"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">108</span><span class="p">,</span><span class="w">
            </span><span class="s2">"fields"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="s2">"choices"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"0"</span><span class="p">,</span><span class="w"> </span><span class="s2">"1"</span><span class="p">,</span><span class="w"> </span><span class="s2">"2"</span><span class="p">,</span><span class="w"> </span><span class="s2">"3"</span><span class="p">,</span><span class="w"> </span><span class="s2">"4"</span><span class="p">,</span><span class="w"> </span><span class="s2">"5"</span><span class="p">,</span><span class="w"> </span><span class="s2">"6"</span><span class="p">]</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"colName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"travel_mode_alt_study"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"prompt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Do you use any alternative mode of travel to your studies?"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">109</span><span class="p">,</span><span class="w">
            </span><span class="s2">"fields"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="s2">"choices"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"0"</span><span class="p">,</span><span class="w"> </span><span class="s2">"1"</span><span class="p">,</span><span class="w"> </span><span class="s2">"2"</span><span class="p">,</span><span class="w"> </span><span class="s2">"3"</span><span class="p">,</span><span class="w"> </span><span class="s2">"4"</span><span class="p">,</span><span class="w"> </span><span class="s2">"5"</span><span class="p">,</span><span class="w"> </span><span class="s2">"6"</span><span class="p">,</span><span class="w"> </span><span class="s2">"7"</span><span class="p">]</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"colName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Gender"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"prompt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"What is your gender?"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w">
            </span><span class="s2">"fields"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="s2">"choices"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"0"</span><span class="p">,</span><span class="w"> </span><span class="s2">"1"</span><span class="p">,</span><span class="w"> </span><span class="s2">"2"</span><span class="p">]</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"colName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Age"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"prompt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"What is your age bracket?"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">101</span><span class="p">,</span><span class="w">
            </span><span class="s2">"fields"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="s2">"choices"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"0"</span><span class="p">,</span><span class="w"> </span><span class="s2">"1"</span><span class="p">,</span><span class="w"> </span><span class="s2">"2"</span><span class="p">,</span><span class="w"> </span><span class="s2">"3"</span><span class="p">,</span><span class="w"> </span><span class="s2">"4"</span><span class="p">,</span><span class="w"> </span><span class="s2">"5"</span><span class="p">]</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"colName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dropdown"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"prompt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dropdown selection title"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
            </span><span class="s2">"fields"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="s2">"choices"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"Choice 1"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Choice 2"</span><span class="p">]</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"colName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"checkbox"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"prompt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"checkbox selection title"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
            </span><span class="s2">"fields"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="s2">"choices"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"Choice 1"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Choice 2"</span><span class="p">]</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"colName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"number"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"prompt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"number selection title"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
            </span><span class="s2">"fields"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="s2">"choices"</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"colName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"text"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"prompt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"text field input title"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w">
            </span><span class="s2">"fields"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="s2">"choices"</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"colName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Email"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"prompt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Please enter your email"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">103</span><span class="p">,</span><span class="w">
            </span><span class="s2">"fields"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="s2">"choices"</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"colName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"location_work"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"prompt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Please enter your work location on the map"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">107</span><span class="p">,</span><span class="w">
            </span><span class="s2">"fields"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"latitude"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="s2">"longitude"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">}</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"colName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"address"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"prompt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"address input title"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w">
            </span><span class="s2">"fields"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"latitude"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="s2">"longitude"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">}</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"colName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"location_study"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"prompt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Please enter your study location on the map"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">106</span><span class="p">,</span><span class="w">
            </span><span class="s2">"fields"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"latitude"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="s2">"longitude"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">}</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"colName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"location_home"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"prompt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Please enter your home location on the map"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">105</span><span class="p">,</span><span class="w">
            </span><span class="s2">"fields"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"latitude"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="s2">"longitude"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">}</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="s2">"prompt"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"maxDays"</span><span class="p">:</span><span class="w"> </span><span class="mi">14</span><span class="p">,</span><span class="w">
        </span><span class="s2">"prompts"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="s2">"colName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dropdown_prompt"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"prompt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dropdown prompt title"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
                </span><span class="s2">"choices"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"Choice 1"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Choice 2"</span><span class="p">]</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="s2">"colName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"checkbox_prompt"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"prompt"</span><span class="p">:</span><span class="w"> </span><span class="s2">"checkbox prompt title"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
                </span><span class="s2">"choices"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"Choice 1"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Choice 2"</span><span class="p">]</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">],</span><span class="w">
        </span><span class="s2">"maxPrompts"</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w">
        </span><span class="s2">"numPrompts"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"user"</span><span class="p">:</span><span class="w"> </span><span class="s2">"New user successfully registered."</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><h3 id='survey-questions'>Survey Questions</h3>
<p>The <code>survey</code> values provides the ordered list of survey questions created using the dashboard&#39;s survey builder. The attributes for each survey question are detailed below.</p>

<table><thead>
<tr>
<th>Key</th>
<th>Value Types</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>colName</code></td>
<td><em>string</em></td>
<td>The column label provided by admin users in the survey builder for output .csv files; currently also used by mobile apps as the question title -- this should like be reconsidered since formatting can be inconsistent</td>
</tr>
<tr>
<td><code>prompt</code></td>
<td><em>string</em></td>
<td>The question string for each survey question</td>
</tr>
<tr>
<td><code>id</code></td>
<td><em>integer</em></td>
<td>The generic field type ID as described in the generic or hardcoded fields tables</td>
</tr>
<tr>
<td><code>fields</code></td>
<td><em>dictionary</em></td>
<td>A dictionary object containing the <code>field names</code> as keys from the generic  or hardcoded fields tables</td>
</tr>
</tbody></table>
<h3 id='generic-fields'>Generic Fields</h3>
<table><thead>
<tr>
<th>id</th>
<th>Field Names</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>1</td>
<td><em>choices</em></td>
<td>select one</td>
</tr>
<tr>
<td>2</td>
<td><em>choices</em></td>
<td>select many</td>
</tr>
<tr>
<td>3</td>
<td><em>number</em></td>
<td>number input</td>
</tr>
<tr>
<td>4</td>
<td><em>latitude</em>, <em>longitude</em></td>
<td>map/address</td>
</tr>
<tr>
<td>5</td>
<td><em>text</em></td>
<td>text box</td>
</tr>
</tbody></table>
<h3 id='hardcoded-fields'>Hardcoded Fields</h3>
<p>Fields with an <code>id</code> greater or equal to 100 are hardcoded fields and mandatory within every survey. In the future, these will be pre-built, but optional components within the survey builder.</p>

<table><thead>
<tr>
<th>id</th>
<th>Hardcoded colName</th>
<th><strong>Field Names (placeholder)</strong></th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>100</td>
<td><code>Gender</code></td>
<td><em>choices</em></td>
<td>gender</td>
</tr>
<tr>
<td>101</td>
<td><code>Age</code></td>
<td><em>choices</em></td>
<td>age</td>
</tr>
<tr>
<td>102</td>
<td><code>mode</code></td>
<td><em>choices</em></td>
<td>primary mode (unused)</td>
</tr>
<tr>
<td>103</td>
<td><code>Email</code></td>
<td><em>choices</em></td>
<td>email</td>
</tr>
<tr>
<td>104</td>
<td><code>member_type</code></td>
<td><em>choices</em></td>
<td>primary occupation</td>
</tr>
<tr>
<td>105</td>
<td><code>location_home</code></td>
<td><em>latitude</em>, <em>longitude</em></td>
<td>mark user&#39;s home location on map</td>
</tr>
<tr>
<td>106</td>
<td><code>location_study</code></td>
<td><em>latitude</em>, <em>longitude</em></td>
<td>mark user&#39;s study location on map</td>
</tr>
<tr>
<td>107</td>
<td><code>location_work</code></td>
<td><em>latitude</em>, <em>longitude</em></td>
<td>mark user&#39;s work location on map</td>
</tr>
<tr>
<td>108</td>
<td><code>travel_mode_study</code></td>
<td><em>choices</em></td>
<td>primary travel mode to study location</td>
</tr>
<tr>
<td>109</td>
<td><code>travel_mode_alt_study</code></td>
<td><em>choices</em></td>
<td>alternate travel mode to study location</td>
</tr>
<tr>
<td>110</td>
<td><code>travel_mode_work</code></td>
<td><em>choices</em></td>
<td>primary travel mode work location</td>
</tr>
<tr>
<td>111</td>
<td><code>travel_mode_alt_work</code></td>
<td><em>choices</em></td>
<td>alternate travel mode to work location</td>
</tr>
</tbody></table>
<h1 id='updating-the-database'>Updating the Database</h1><h2 id='answering-the-survey'>Answering the Survey</h2><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">json</span>

<span class="n">test_data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">"survey"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">"checkbox"</span><span class="p">:</span> <span class="p">[</span><span class="s">"Choice 1"</span><span class="p">],</span>
        <span class="s">"dropdown"</span><span class="p">:</span> <span class="s">"Choice 2"</span><span class="p">,</span>
        <span class="s">"Gender"</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s">"travel_mode_work"</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
        <span class="s">"address"</span><span class="p">:</span> <span class="p">{</span>
            <span class="s">"latitude"</span><span class="p">:</span> <span class="o">-</span><span class="mf">12.5665545</span><span class="p">,</span>
            <span class="s">"longitude"</span><span class="p">:</span> <span class="o">-</span><span class="mf">41.789760</span>
        <span class="p">},</span>
        <span class="s">"number"</span><span class="p">:</span> <span class="mi">5789</span><span class="p">,</span>
        <span class="s">"travel_mode_alt_work"</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
        <span class="s">"Email"</span><span class="p">:</span> <span class="s">"vpollich@tillman-heathcote.com"</span><span class="p">,</span>
        <span class="s">"travel_mode_alt_study"</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s">"member_type"</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s">"text"</span><span class="p">:</span> <span class="s">"Cumque nemo occaecati aliquid nam iusto rem itaque. Aperiam saepe itaque quas odit accusantium. Recusandae maiores consequatur esse veniam sequi odit."</span><span class="p">,</span>
        <span class="s">"location_home"</span><span class="p">:</span> <span class="p">{</span>
            <span class="s">"latitude"</span><span class="p">:</span> <span class="o">-</span><span class="mf">14.643098</span><span class="p">,</span>
            <span class="s">"longitude"</span><span class="p">:</span> <span class="o">-</span><span class="mf">80.968816</span>
        <span class="p">},</span>
        <span class="s">"location_study"</span><span class="p">:</span> <span class="p">{</span>
            <span class="s">"latitude"</span><span class="p">:</span> <span class="o">-</span><span class="mf">84.0534215</span><span class="p">,</span>
            <span class="s">"longitude"</span><span class="p">:</span> <span class="mf">144.383503</span>
        <span class="p">},</span>
        <span class="s">"location_work"</span><span class="p">:</span> <span class="p">{</span>
            <span class="s">"latitude"</span><span class="p">:</span> <span class="o">-</span><span class="mf">13.8300325</span><span class="p">,</span>
            <span class="s">"longitude"</span><span class="p">:</span> <span class="mf">101.956003</span>
        <span class="p">},</span>
        <span class="s">"Age"</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s">"travel_mode_study"</span><span class="p">:</span> <span class="mi">4</span>
    <span class="p">},</span>
    <span class="s">"uuid"</span><span class="p">:</span> <span class="s">"d5f7eb50-6dec-48d1-86ff-ee4b96b583f7"</span>
<span class="p">}</span>
<span class="n">parameters</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">parameters</span><span class="p">)</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"success"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MobileUpdateData"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"results"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"prompts"</span><span class="p">:</span><span class="w"> </span><span class="s2">"No new prompt answers supplied."</span><span class="p">,</span><span class="w">
        </span><span class="s2">"survey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Survey answer for 0eb506b1-0411-4c91-8422-58ad44180272 upserted."</span><span class="p">,</span><span class="w">
        </span><span class="s2">"coordinates"</span><span class="p">:</span><span class="w"> </span><span class="s2">"No new coordinates data supplied."</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<aside class="notice">Keys within <code>survey</code> attribute do not adhere to the camelCase requirements since these keys will be determined by the user via the dashboard's survey builder. The original hardcoded questions also retain underscores to introduce less breaking changes and eventually these will be deprecated in favor of new <b><a href="#parsing-the-survey">generic fields</a></b> with the same purpose.

<br></br>

<i>This seemed an acceptable trade-off since they are dynamic fields and will not be relied on by the app except in special hardcoded circumstances for existing tailored mobile apps.</i></aside>

<p>This endpoint is shared with updates for coordinates, prompts, and cancelled prompts. This follows the design of the original API, however, it now requires only the necessary data to be submitted (i.e., the survey answers do not need to be sent in each request).</p>
<h3 id='http-request-2'>HTTP Request</h3>
<p><code>POST http://&lt;api.root.url&gt;/mobile/v1/update</code></p>
<h3 id='query-parameters-2'>Query Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>uuid</code></td>
<td>The user&#39;s cached installation uuid</td>
</tr>
<tr>
<td><code>survey</code></td>
<td>Dictionary containing the column names from the supplied schema and the user input values</td>
</tr>
</tbody></table>
<h2 id='adding-coordinates'>Adding Coordinates</h2><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">requests</span>

<span class="n">test_data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">"uuid"</span><span class="p">:</span> <span class="s">"04399688-f7aa-4e7d-aeda-a54de210d843"</span><span class="p">,</span>
    <span class="s">"coordinates"</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s">"latitude"</span><span class="p">:</span> <span class="mf">45.5069920593</span><span class="p">,</span>
            <span class="s">"longitude"</span><span class="p">:</span> <span class="o">-</span><span class="mf">73.6316462699</span><span class="p">,</span>
            <span class="s">"altitude"</span><span class="p">:</span> <span class="mf">32.34234</span><span class="p">,</span>
            <span class="s">"speed"</span><span class="p">:</span> <span class="mf">48.07675588398361</span><span class="p">,</span>
            <span class="s">"direction"</span><span class="p">:</span> <span class="mf">164.3948</span><span class="p">,</span>
            <span class="s">"hAccuracy"</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
            <span class="s">"vAccuracy"</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
            <span class="s">"accelerationX"</span><span class="p">:</span> <span class="mf">0.3757285807726195</span><span class="p">,</span>
            <span class="s">"accelerationY"</span><span class="p">:</span> <span class="mf">0.9005850917305266</span><span class="p">,</span>
            <span class="s">"accelerationZ"</span><span class="p">:</span> <span class="mf">0.6462882776492511</span><span class="p">,</span>
            <span class="s">"modeDetected"</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s">"pointType"</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
            <span class="s">"timestamp"</span><span class="p">:</span> <span class="s">"2016-10-29T09:25:33-04:00"</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s">"latitude"</span><span class="p">:</span> <span class="mf">45.4709612219</span><span class="p">,</span>
            <span class="s">"longitude"</span><span class="p">:</span> <span class="o">-</span><span class="mf">73.6011947415</span><span class="p">,</span>
            <span class="s">"altitude"</span><span class="p">:</span> <span class="mf">31.82743</span><span class="p">,</span>
            <span class="s">"speed"</span><span class="p">:</span> <span class="mf">51.04449870001568</span><span class="p">,</span>
            <span class="s">"direction"</span><span class="p">:</span> <span class="mf">162.83454384</span><span class="p">,</span>
            <span class="s">"hAccuracy"</span><span class="p">:</span> <span class="mi">14</span><span class="p">,</span>
            <span class="s">"vAccuracy"</span><span class="p">:</span> <span class="mi">19</span><span class="p">,</span>
            <span class="s">"modeDetected"</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
            <span class="s">"accelerationX"</span><span class="p">:</span> <span class="mf">0.7981422356509369</span><span class="p">,</span>
            <span class="s">"accelerationY"</span><span class="p">:</span> <span class="mf">0.7147102339936264</span><span class="p">,</span>
            <span class="s">"accelerationZ"</span><span class="p">:</span> <span class="mf">0.47743632708330497</span><span class="p">,</span>
            <span class="s">"modeDetected"</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s">"pointType"</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s">"timestamp"</span><span class="p">:</span> <span class="s">"2016-10-29T09:25:48-04:00"</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s">"latitude"</span><span class="p">:</span> <span class="mf">45.5026375686</span><span class="p">,</span>
            <span class="s">"longitude"</span><span class="p">:</span> <span class="o">-</span><span class="mf">73.6364625799</span><span class="p">,</span>
            <span class="s">"altitude"</span><span class="p">:</span> <span class="mf">33.11732</span><span class="p">,</span>
            <span class="s">"speed"</span><span class="p">:</span> <span class="mf">53.47408048034383</span><span class="p">,</span>
            <span class="s">"direction"</span><span class="p">:</span> <span class="mf">163.28343</span><span class="p">,</span>
            <span class="s">"hAccuracy"</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s">"vAccuracy"</span><span class="p">:</span> <span class="mi">21</span><span class="p">,</span>
            <span class="s">"accelerationX"</span><span class="p">:</span> <span class="mf">0.23135915741337032</span><span class="p">,</span>
            <span class="s">"accelerationY"</span><span class="p">:</span> <span class="mf">0.6164638302522808</span><span class="p">,</span>
            <span class="s">"accelerationZ"</span><span class="p">:</span> <span class="mf">0.11871749871078396</span><span class="p">,</span>
            <span class="s">"modeDetected"</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s">"pointType"</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
            <span class="s">"timestamp"</span><span class="p">:</span> <span class="s">"2016-10-29T09:26:03-04:00"</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="o">...</span>
    <span class="p">]</span>
<span class="p">}</span>

<span class="n">parameters</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">update_url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">parameters</span><span class="p">)</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"success"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MobileUpdateData"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"results"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"prompts"</span><span class="p">:</span><span class="w"> </span><span class="s2">"No new prompt answers supplied."</span><span class="p">,</span><span class="w">
        </span><span class="s2">"survey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"No new survey data supplied."</span><span class="p">,</span><span class="w">
        </span><span class="s2">"coordinates"</span><span class="p">:</span><span class="w"> </span><span class="s2">"New coordinates for 96fc430b-284d-45c5-9eef-bd2796a73d31 inserted."</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre>
<p>Allows application to send recorded GPS points to the server. This endpoint is shared with updates for survey responses and may be combined into a single request.</p>
<h3 id='http-request-3'>HTTP Request</h3>
<p><code>POST http://&lt;api.root.url&gt;/mobile/v1/update</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>uuid</code></td>
<td>The user&#39;s cached installation uuid</td>
</tr>
<tr>
<td><code>coordinates</code></td>
<td>Array of dictionaries containing GPS points information</td>
</tr>
<tr>
<td><code>cancelledPrompts</code></td>
<td>(Optional) array of cancelled prompts dictionaries</td>
</tr>
<tr>
<td><code>prompts</code></td>
<td>(Optional) array of prompt responses dictionaries</td>
</tr>
</tbody></table>
<h2 id='upserting-prompts'>Upserting Prompts</h2><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">requests</span>

<span class="n">test_data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">"prompts"</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s">"uuid"</span><span class="p">:</span> <span class="s">"0dd86866-9e00-474f-a24b-103431254726"</span><span class="p">,</span>
            <span class="s">"displayedAt"</span><span class="p">:</span> <span class="s">"2017-04-27T08:37:03-04:00"</span><span class="p">,</span>
            <span class="s">"recordedAt"</span><span class="p">:</span> <span class="s">"2017-04-27T08:37:03-04:00"</span><span class="p">,</span>
            <span class="s">"longitude"</span><span class="p">:</span> <span class="o">-</span><span class="mf">73.5769640073</span><span class="p">,</span>
            <span class="s">"latitude"</span><span class="p">:</span> <span class="mf">45.4868670481</span><span class="p">,</span>
            <span class="s">"answer"</span><span class="p">:</span> <span class="s">"Choice 1"</span><span class="p">,</span>
            <span class="s">"prompt_num"</span><span class="p">:</span> <span class="mi">0</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s">"uuid"</span><span class="p">:</span> <span class="s">"0dd86866-9e00-474f-a24b-103431254726"</span><span class="p">,</span>
            <span class="s">"displayedAt"</span><span class="p">:</span> <span class="s">"2017-04-28T07:24:25-04:00"</span><span class="p">,</span>
            <span class="s">"recordedAt"</span><span class="p">:</span> <span class="s">"2017-04-28T07:24:25-04:00"</span><span class="p">,</span>
            <span class="s">"longitude"</span><span class="p">:</span> <span class="o">-</span><span class="mf">73.6179342516</span><span class="p">,</span>
            <span class="s">"latitude"</span><span class="p">:</span> <span class="mf">45.5205378578</span><span class="p">,</span>
            <span class="s">"answer"</span><span class="p">:</span> <span class="p">[</span><span class="s">"Choice A"</span><span class="p">,</span> <span class="s">"Choice C"</span><span class="p">],</span>
            <span class="s">"promptNum"</span><span class="p">:</span> <span class="mi">1</span>
        <span class="p">}</span>
    <span class="p">],</span>
    <span class="s">"uuid"</span><span class="p">:</span> <span class="s">"bb9212b8-a608-48a2-962e-3ecb9632a12b"</span><span class="p">,</span>
    <span class="s">"coordinates"</span><span class="p">:</span> <span class="p">[]</span>
<span class="p">}</span>

<span class="n">parameters</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">update_url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">parameters</span><span class="p">)</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"success"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MobileUpdateData"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"results"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"prompts"</span><span class="p">:</span><span class="w"> </span><span class="s2">"New prompt answers for bb9212b8-a608-48a2-962e-3ecb9632a12b inserted."</span><span class="p">,</span><span class="w">
        </span><span class="s2">"survey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"No new survey data supplied."</span><span class="p">,</span><span class="w">
        </span><span class="s2">"coordinates"</span><span class="p">:</span><span class="w"> </span><span class="s2">"No new coordinates data supplied."</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>Prompt question types use the same <a href="#parsing-the-survey">generic fields</a> format as the survey questions. Prompt question types can be either dropdown/&quot;select one&quot; (1), checkboxes/&quot;select many&quot; (2), or text box/&quot;unformatted text field&quot; (5). This endpoint is shared with updates for survey responses and may be combined to a single request. Each prompt requires the following information:</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>uuid</code></td>
<td>UUID for each prompt event, prompts displayed during the same prompt event (i.e., app has detected that user has made a stop) should share the same UUID</td>
</tr>
<tr>
<td><code>promptNum</code></td>
<td>Index (start=0) of the prompt being answered during a prompt event</td>
</tr>
<tr>
<td><code>displayedAt</code></td>
<td>IS08601 representation of datetime when app created prompt event</td>
</tr>
<tr>
<td><code>recordedAt</code></td>
<td>ISO8601 representation of datetime when user answered prompt event</td>
</tr>
<tr>
<td><code>longitude</code></td>
<td>Longitude of where prompt event was created</td>
</tr>
<tr>
<td><code>latitude</code></td>
<td>Latitude of where prompt event was created</td>
</tr>
<tr>
<td><code>answer</code></td>
<td>List of plain-text strings for the user&#39;s prompt response</td>
</tr>
</tbody></table>

<p>Updated prompts may be resubmitted with the same format as long as the UUID remains consistent with the originally submitted prompt.</p>

<p><code>POST http://&lt;api.root.url&gt;/mobile/v1/update</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>uuid</code></td>
<td><code>uuid</code> for mobile user (different from prompt <code>uuid</code> above)</td>
</tr>
<tr>
<td><code>prompts</code></td>
<td>Array of user&#39;s prompt responses</td>
</tr>
<tr>
<td><code>cancelledPrompts</code></td>
<td>(Optional) array of cancelled prompts dictionaries</td>
</tr>
<tr>
<td><code>coordinates</code></td>
<td>(Optional) array of dictionaries containing GPS points information</td>
</tr>
</tbody></table>
<h2 id='adding-cancelled-prompts'>Adding Cancelled Prompts</h2><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">requests</span>

<span class="n">test_data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">"cancelledPrompts"</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s">"uuid"</span><span class="p">:</span> <span class="s">"c1d15413-b33d-4aaa-bf84-762517a3284b"</span><span class="p">,</span>
            <span class="s">"displayedAt"</span><span class="p">:</span> <span class="s">"2017-04-27T08:37:03-04:00"</span><span class="p">,</span>
            <span class="s">"cancelledAt"</span><span class="p">:</span> <span class="s">"2017-04-27T08:37:03-04:00"</span><span class="p">,</span>
            <span class="s">"longitude"</span><span class="p">:</span> <span class="o">-</span><span class="mf">73.5769640073</span><span class="p">,</span>
            <span class="s">"latitude"</span><span class="p">:</span> <span class="mf">45.4868670481</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s">"uuid"</span><span class="p">:</span> <span class="s">"e2dd9ab2-f859-4d44-b569-6791a4a2ed7b"</span><span class="p">,</span>
            <span class="s">"displayedAt"</span><span class="p">:</span> <span class="s">"2017-04-28T07:24:25-04:00"</span><span class="p">,</span>
            <span class="s">"cancelledAt"</span><span class="p">:</span> <span class="s">"2017-04-28T07:24:25-04:00"</span><span class="p">,</span>
            <span class="s">"longitude"</span><span class="p">:</span> <span class="o">-</span><span class="mf">73.6179342516</span><span class="p">,</span>
            <span class="s">"latitude"</span><span class="p">:</span> <span class="mf">45.5205378578</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">],</span>
    <span class="s">"uuid"</span><span class="p">:</span> <span class="s">"bb9212b8-a608-48a2-962e-3ecb9632a12b"</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">parameters</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">cancelled_prompts_url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">parameters</span><span class="p">)</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"results"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"cancelledPrompts"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2 false prompts recorded."</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"success"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MobileUpdateData"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>This endpoint records times when a user is prompted about a trip end, but chooses to continue their trip and dismisses the prompt. Cancelled prompts are mutually exclusive events from answered prompts and should never share UUIDs. Previously submitted cancelled prompts will be upgraded automatically by submitting an answered prompt set with the same UUID.</p>
<h3 id='http-request-4'>HTTP Request</h3>
<p><code>POST http://&lt;api.root.url&gt;/mobile/v1/update</code></p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>uuid</code></td>
<td><code>uuid</code> for mobile user</td>
</tr>
<tr>
<td><code>cancelledPrompts</code></td>
<td>Array of cancelled prompts dictionaries</td>
</tr>
<tr>
<td><code>coordinates</code></td>
<td>(Optional) array of dictionaries containing GPS points information</td>
</tr>
<tr>
<td><code>prompts</code></td>
<td>(Optional) array of prompt responses dictionaries</td>
</tr>
</tbody></table>
<h1 id='errors'>Errors</h1>
<p>Generally the only errors you will receive are <code>400</code>, <code>404</code>, <code>405</code> or <code>500</code>. Because the API is overly-forgiving, requests that attempt to create a duplicate user or are otherwise unacceptable will yield <code>200</code> indicating it was well formatted, but provide a message describing the internal failure.</p>

<table><thead>
<tr>
<th>Error Code</th>
<th>Meaning</th>
</tr>
</thead><tbody>
<tr>
<td>400</td>
<td>Bad Request</td>
</tr>
<tr>
<td>401</td>
<td>Unauthorized</td>
</tr>
<tr>
<td>403</td>
<td>Forbidden</td>
</tr>
<tr>
<td>404</td>
<td>Not Found</td>
</tr>
<tr>
<td>405</td>
<td>Method Not Allowed</td>
</tr>
<tr>
<td>500</td>
<td>Internal Server Error</td>
</tr>
<tr>
<td>503</td>
<td>Service Unavailable</td>
</tr>
</tbody></table>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="python">python</a>
          </div>
      </div>
    </div>
  </body>
</html>
